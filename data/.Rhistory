mcmcplot(mcmc.output.4$samples)
load("./enes_model.RData")
rm(list=ls())
setwd("C:/Users/jasmi/OneDrive/Documents/Academic/OSU/Git/oss-occu/data")
library(nimble)
library(ggplot2)
library(data.table)
library(tidyverse)
library(mcmcplots)
library(MCMCvis)
library(boot)
source('attach.nimble_v2.R')
# enes model:
load("./enes_model.RData")
mcmcplot(mcmc.output.4$samples)
# ACF plots
acf(DetectionIntercept)
acf(TreatmentIntercept)
attach.nimble(mcmc.output.4$samples)
save(mcmc.output.4, file="./enes_model.RData")
# ACF plots
acf(DetectionIntercept)
acf(TreatmentIntercept)
# Inverse logit the detection intercept to get detection probabilities
det.probs.inv <- inv.logit(DetectionIntercept)
hist(det.probs.inv)
# Looking at trace plots and parameter estimates
MCMCtrace(object = mcmc.output.4$samples,
pdf = FALSE, # no export to PDF
ind = TRUE, # separate density lines per chain
params = c("DetectionIntercept", "betaTemp", "TreatmentIntercept"))
mean(det.probs.inv) # = 0.26108
mean(det.probs.inv>0)  # = 1
median(det.probs.inv)  # = 0.2597028
boxplot(det.probs.inv)
# Inv logit TreatmentIntercept to get Occupancy Estimates
trt.int.inv <- inv.logit(TreatmentIntercept)
median(trt.int.inv[,1]) # 0.6392119    BS
median(trt.int.inv[,2]) # 0.8090534    BU
median(trt.int.inv[,3]) # 0.5784290    HB
median(trt.int.inv[,4]) # 0.6915276    HU
median(trt.int.inv[,5]) # 0.9920444    UU
# Renaming and reordering the treatment intercepts for the boxplot
trt.int.inv <- inv.logit(TreatmentIntercept)
treatment_matrix <- trt.int.inv # Using the inv logit treatment estimates
new.names <- c("Salvage Logged", "Wildfire", "Harvest, Wildfire", "Harvest", "Control")
colnames(treatment_matrix) <- new.names
desired.order <- c("Control", "Wildfire", "Harvest, Wildfire", "Harvest", "Salvage Logged")
box.colors <- c('lightgreen','steelblue', 'coral2', '#f9d62e', '#b967ff' )
#boxplot of Treatment Estimates - occu prob for each treatment
boxplot(treatment_matrix[, match(desired.order, colnames(treatment_matrix))],
main = "Treatment Intercepts for All Species",
xlab = "Treatment", ylab = "Occupancy Probability",
col = box.colors)
dev.off()
#define treatments using the inv logit treatment estimates
treatment_matrix <- trt.int.inv
#treatments are numbered, need to give them names
new.names <- c("Salvage Logged", "Wildfire", "Harvest, Wildfire", "Harvest", "Control")
colnames(treatment_matrix) <- new.names
treatment_matrix <- as.data.frame(treatment_matrix)
#reshape data to long format bc ggplot required
long_format <- gather(treatment_matrix, key = "Treatment", value = "Occupancy_Probability")
#specify treatment order for plot
long_format$Treatment <- factor(long_format$Treatment,
levels = c("Control", "Wildfire", "Harvest, Wildfire", "Harvest", "Salvage Logged")) # Replace "DesiredOrder", "Treat1", etc., with your actual treatment names in the desired order
box.colors <- c('lightgreen','steelblue', 'coral2', '#f9d62e', '#b967ff' )
ggplot(long_format, aes(x = Treatment, y = Occupancy_Probability, fill = Treatment)) +
geom_boxplot() +
theme_classic() +
scale_fill_manual(values = box.colors) +
labs(title = "Treatment Intercepts for ENES", x = "Treatment", y = "Occupancy Probability") +
theme(plot.title = element_text(hjust = 0.5)) # Center the title
p <- ggplot(long_format, aes(x = Treatment, y = Occupancy_Probability, fill = Treatment)) +
geom_boxplot() +
theme_classic() +
scale_fill_manual(values = box.colors) +
labs(title = "Treatment Intercepts for ENES", x = "Treatment", y = "Occupancy Probability") +
theme(plot.title = element_text(hjust = 0.5)) # Center the title
ggsave(filename = "enes_trt_occu_prob.png", plot = p, device = "png",
path = "C:/Users/jasmi/OneDrive/Documents/Academic/OSU/Git/oss-occu/figures/06-rework-nimble-models",
width = 10, height = 6, units = "in", dpi = 300)
